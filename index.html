<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="icon" href="./icon.png" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="Srste Platform" />
    <link rel="apple-touch-icon" href="./icon.png" />
    <link rel="manifest" href="./manifest.json" />
    <script async="" type="text/javascript" src="/monaco-editor/dev/vs/loader.js"></script>
    <script async="async" type="text/javascript" src="/monaco-editor/dev/vs/editor/editor.main.js"></script>
    <link rel="stylesheet" data-name="vs/editor/editor.main" href="static/styles/editor.main.css">
    <script async="async" type="text/javascript" src="/monaco-editor/dev/vs/editor/editor.main.nls.js"></script>
    <script async="async" type="text/javascript" src="/monaco-editor/dev/vs/basic-languages/html/html.js"></script>
    <script async="async" type="text/javascript" src="/monaco-editor/dev/vs/language/html/htmlMode.js"></script>
    <script async="async" type="text/javascript" src="/monaco-editor/dev/vs/language/html/htmlWorker.js"></script>
    <title>Srste</title>
    <script>
        window.__SRS__ = {};
        window.__SRS__.mode = "sandbox";
    </script>
    <script defer="defer" src="./srste.js"></script>
    <link href="./static/css/main.621ff9de.css" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
    <script defer="defer" src="./srste.js"></script>
    <link href="./static/css/main.621ff9de.css" rel="stylesheet">
</head>

<link rel="stylesheet" href="./assets/css/page.css">
<link rel="stylesheet" href="./assets/css/customstyles.css">

<script type="module" src="./assets/cdn/zero-md.js"></script>
<script src="./assets/scripts/copyCode.js"></script>
<div>
    <div class="w3-sidebar w3-bar-block w3-card w3-animate-left" style="display:none" id="mySidebar">
        <button class="w3-bar-item w3-button w3-large" onclick="menuClose()">Close &times;</button>
        <div id="sidebar-items">

        </div>
    </div>

    <div id="main">
        <div class="w3-teal">
            <button id="openNav" class="w3-button w3-teal w3-xlarge" onclick="menuOpen()">&#9776;</button>
            <div class="w3-container">
                <h1>Srste- Documentation</h1>
            </div>
        </div>
    </div>
</div>

<div class="templateCategories">
</div>
<div class="imagesContainer">
</div>
<div id="__srsteroot__" style="overflow:hidden;max-height:100vh"></div>

<script>
    async function loadEditorData() {
        debugger;
        let {getPageDetails} = await import('./media/json/inlineUIEditor.js');
        let editorData = await getPageDetails();
        if(editorData) {
            window.__SRS__ = window.__SRS__ || {};
            window.__SRS__.contents = editorData.pageContents;
            window.__SRS__.context = editorData.pageContext;
            window.__SRS__.functions = editorData.pageFunctions;
            window.__SRS__.mode = "sandbox";
            dispatchEvent(new CustomEvent("GLOBAL_CONTENTS_UPDATED", {}));
        } 
    }
    loadEditorData();
</script>

<script>
    loadContents();
    function loadContents() {
        var zeroMDElement = document.createElement("zero-md")
        zeroMDElement.id = "pageContainer";
        var page = "Home";
        var queryString = window.location.search?.substr(1) || "";
        if (queryString) {
            var queryStringPairs = queryString.split("&");
            queryStringPairs.forEach((queryStringPair) => {
                var queryKeyValue = queryStringPair.split("=");
                if (queryKeyValue[0] == "page") {
                    page = queryKeyValue[1];
                    zeroMDElement.setAttribute("src", "./pages/" + page + ".md" || "./pages/Home.md");
                }
            });
        } else {
            zeroMDElement.setAttribute("src", "./pages/Home.md");
        }

        document.getElementById("main").appendChild(zeroMDElement);
        let sidebarEl = document.getElementById("sidebar-items");
        if (page == "Home") {
            sidebarEl.innerHTML = `                
                <a href="?page=GettingStarted" id="getting_started" class="w3-bar-item w3-button">Getting Started</a>
                <a href="?page=BuildingExperiences" class="w3-bar-item w3-button">Building Experiences</a>
                <a href="?page=CreatingPages" class="w3-bar-item w3-button">Creating Pages</a>
                <a href="?page=CreatingContentTypes" class="w3-bar-item w3-button">Creating Content Types</a>
                <a href="?page=Templates" class="w3-bar-item w3-button">Templates</a>`;
        } else if (page == "GettingStarted") {
            sidebarEl.innerHTML = `
                <a href="?page=Home" id="getting_started" class="w3-bar-item w3-button">Home</a>                                
                <a href="?page=BuildingExperiences" class="w3-bar-item w3-button">Building Experiences</a>
                <a href="?page=CreatingPages" class="w3-bar-item w3-button">Creating Pages</a>
                <a href="?page=CreatingContentTypes" class="w3-bar-item w3-button">Creating Content Types</a>
                <a href="?page=Templates" class="w3-bar-item w3-button">Templates</a>`;
        } else if (page == "BuildingExperiences") {
            sidebarEl.innerHTML = `
                <a href="?page=Home" id="getting_started" class="w3-bar-item w3-button">Home</a>                                
                <a href="?page=Setup" class="w3-bar-item w3-button">Setup</a>
                <a href="?page=Configurations" class="w3-bar-item w3-button">Configurations</a>                
                <a href="?page=Templates" class="w3-bar-item w3-button">Templates</a>`;
        } else if (page == "CreatingPages") {
            sidebarEl.innerHTML = `
                <a href="?page=Home" id="getting_started" class="w3-bar-item w3-button">Home</a>                                
                <a href="?page=StepByStepGuide" class="w3-bar-item w3-button">Step by Step Guide</a>
                <a href="?page=PageTemplates" class="w3-bar-item w3-button">Page Templates</a>
                <a href="?page=AddingContentBlocks" class="w3-bar-item w3-button">Adding Content Blocks</a>
                <a href="?page=AddingModalsPopovers" class="w3-bar-item w3-button">Adding Modals & Popovers</a>
                <a href="?page=StylingContentBlocks" class="w3-bar-item w3-button">Styling Content Blocks</a>
                <a href="?page=EventHandling" class="w3-bar-item w3-button">Event Handling</a>
                <a href="?page=ClientScripting" class="w3-bar-item w3-button">Client Scripting</a>
                <a href="?page=ClientScriptingAPI" class="w3-bar-item w3-button">Client Scripting API</a>
                <a href="?page=ClientContext" class="w3-bar-item w3-button">Client Context</a>
                <a href="?page=DataFlows" class="w3-bar-item w3-button">Data Flows</a>
                <a href="?page=Templates" class="w3-bar-item w3-button">Templates</a>`;
        } else if (page == "CreatingContentTypes") {
            sidebarEl.innerHTML = `
                <a href="?page=Home" id="getting_started" class="w3-bar-item w3-button">Home</a>                                
                <a href="?page=OOBContentBlockType" class="w3-bar-item w3-button">OOTB Content Type & Inventory</a>                
                <a href="?page=ReusableBlock" class="w3-bar-item w3-button">Reusable Block</a>
                <a href="?page=CustomType" class="w3-bar-item w3-button">Custom Content Type</a>
                <a href="?page=GenericBlock" class="w3-bar-item w3-button">Generic Block</a>
                <a href="?page=DataBlock" class="w3-bar-item w3-button">Data Block</a>
                <a href="?page=Templates" class="w3-bar-item w3-button">Templates</a>`;
        } else if (page == "RuntimeExperience") {
            sidebarEl.innerHTML = `
                <a href="?page=Home" id="getting_started" class="w3-bar-item w3-button">Home</a>                                
                <a href="?page=RegisteringArtifacts" class="w3-bar-item w3-button">Registering Artifacts & Loading Contents</a>
                <a href="?page=CachingPerformance" class="w3-bar-item w3-button">Caching & Performance</a>
                <a href="?page=Translations" class="w3-bar-item w3-button">Translations</a>
                <a href="?page=Telemetry" class="w3-bar-item w3-button">Telemetry</a>
                <a href="?page=Templates" class="w3-bar-item w3-button">Templates</a>`;
        } else {
            sidebarEl.innerHTML = `
                <a href="?page=Home" id="getting_started" class="w3-bar-item w3-button">Home</a>                                
                <a href="?page=Templates" class="w3-bar-item w3-button">Templates</a>`;
        }

        if (page == "Templates") {
            loadTemplates();
            showEditor(false)
        } else {
            showEditor(false);
        }
    }

    async function showEditor(showFlag, el) {
        let imagesContainer = document.querySelector(".imagesContainer");
        let editorNode = document.querySelector("#__srsteroot__");
        if (showFlag) {
            imagesContainer.style.display = "none";
            editorNode.style.display = "";
        } else {
            imagesContainer.style.display = "";
            editorNode.style.display = "none";
        }
        if (el) {
            let templateCategoryEls = document.querySelectorAll(".templateCategory");
            templateCategoryEls.forEach((categoryEl) => categoryEl.classList.remove("selected"));
            el.classList.add("selected");
        }
    }

    async function loadTemplates(category, el) {
        let imagesContainer1 = document.querySelector(".imagesContainer");
        imagesContainer1.style.display = "";
        let editorNode = document.querySelector("#__srsteroot__");
        editorNode.style.display = "none";

        if (category) {
            let templateCategoryEls = document.querySelectorAll(".templateCategory");
            templateCategoryEls.forEach((categoryEl) => categoryEl.classList.remove("selected"));
            if (el) {
                el.classList.add("selected");
            }
        } else {
            let templateCategoriesEl = document.querySelector(".templateCategories");
            templateCategoriesEl.innerHTML = `
                <div class="templateCategory" onclick="showEditor(true, this)">Editor</div>
                <div class="templateCategory selected" onclick="loadTemplates('Layout', this)">Layouts</div>
                <div class="templateCategory" onclick="loadTemplates('Container', this)">Container</div>
                <div class="templateCategory" onclick="loadTemplates('Banner', this)">Banners</div>
                <div class="templateCategory" onclick="loadTemplates('Contents', this)">Contents</div>`;
        }

        let imagesContainer = document.querySelector(".imagesContainer");
        let { templateData } = await import("./media/json/getTemplates.js") || [];
        if (category && category != "all") {
            templateData = templateData.filter((templateDataItem) => templateDataItem.category == category);
        } else {
            templateData = templateData.filter((templateDataItem) => templateDataItem.category == "Layout");
        }

        if (imagesContainer) {
            let templateBlocks = "";
            templateData.forEach((templateItem) => {
                templateBlocks = templateBlocks + `<div class="imageContainer">
                        <div class="column1">
                            <div class="topicName">${templateItem.topicName}</div>
                            <div class="topicDescription">${templateItem.topicDescription}</div>
                            <div class="copyBtn">
                                <div class="copyCode" name="${templateItem.templateName}" onclick="copyCode(this)">Copy Contents</div>
                                <div class="copyStatus"></div>
                            </div>
                        </div>
                        <div class="column2"> 
                            <image src="${templateItem.templateImagePath}" class="templateImage"/>
                        </div>
                    </div>
                `;
            });

            imagesContainer.innerHTML = templateBlocks;
        }
    }

    function menuOpen() {
        document.getElementById("main").style.marginLeft = "25%";
        document.getElementById("mySidebar").style.width = "25%";
        document.getElementById("mySidebar").style.display = "block";
        document.getElementById("openNav").style.display = 'none';
    }
    function menuClose() {
        document.getElementById("main").style.marginLeft = "0%";
        document.getElementById("mySidebar").style.display = "none";
        document.getElementById("openNav").style.display = "inline-block";
    }
    async function copyCode(elm) {
        let templateName = elm.getAttribute("name");
        elm.parentElement.querySelector(".copyStatus").innerText = "";
        let { data } = await import('./media/json/' + templateName + '.js');
        await window.navigator.clipboard.writeText(JSON.stringify(data, null, 4));
        await window.navigator.clipboard.readText();
        setTimeout(() => {
            elm.parentElement.querySelector(".copyStatus").innerText = "Copied!";
        }, 1000);
    }
</script>
</html>